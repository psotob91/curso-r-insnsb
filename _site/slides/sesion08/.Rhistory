#| echo: false
#| output: false
# Removing all objects including loaded libraries
rm(list = ls(all = TRUE))
gc()
# Installing and loading packages
if (!require("pacman")) {
install.packages("pacman")
}
pacman::p_unload("all") # Unloading all package except base
pacman::p_load(tidyverse,
tibble,
labelled,
pander,
gt,
kableExtra,
DT,
haven,
skimr,
Hmisc,
janitor,
rio,
gtsummary,
gt,
flextable,
kableExtra,
readxl,
rstatix,
medicaldata,
ggpubr,
car,
performance,
see,
lmtest,
sandwich,
splines2,
plotly) # Loading packages
md_visit <- import("rwm5yr.dta") %>%
characterize()
#| echo: false
set.seed(123)
x = rnorm(500, 0, 1)
y = 4 * x + rnorm(50, 0, 2)
datos <- data.frame(
x = x,
y = y)
#| echo: false
#| fig-align: center
#| fig-width: 7
#| fig-height: 7
datos %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
labs(x = "X", y = "Y") +
theme_bw()
#| echo: false
#| fig-width: 10
#| fig-height: 10
datos %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_abline(aes(x = x, y = y), intercept = -1, slope = 1, colour = "red") +
geom_abline(aes(x = x, y = y), intercept = 0.07, slope = 4.4 , colour = "green") +
geom_abline(aes(x = x, y = y), intercept = 0.07, slope = 3.9 , colour = "orange") +
labs(x = "X", y = "Y") +
theme_bw()
#| echo: false
#| fig-width: 10
#| fig-height: 10
datos %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
labs(x = "X", y = "Y") +
theme_bw()
#| echo: false
set.seed(123)
x <- c(rep(0, 25), rep(1, 25))
y <- 4 * x + rnorm(50, 0, 2)
datos <- data.frame(
x1 = factor(x, levels = c(0, 1), labels = c("Placebo", "Tratamiento Nuevo")),
x2 = x,
y = y)
#| echo: false
datos %>%
ggplot(aes(x = x1, y = y)) +
geom_point() +
theme_bw()
#| echo: false
datos %>%
ggplot(aes(x = x2, y = y)) +
geom_smooth(method = "lm", se = FALSE) +
geom_point() +
theme_bw()
#| echo: false
set.seed(123)
x <- c(rep(0, 25), rep(1, 25))
z <- rnorm(50, 15, 1)
y <- 10 * x - 2 * z + rnorm(50, 0, 2)
datos1 <- data.frame(
x1 = factor(x, levels = c(0, 1), labels = c("Placebo", "Tratamiento Nuevo")),
x2 = x,
x3 = z,
y = y)
lm(y ~ x1, data = datos)
mod <- lm(y ~ x1, data = datos)
summary(mod)
#| echo: false
set.seed(123)
x <- c(rep(0, 25), rep(1, 25))
z <- rnorm(1000, 15, 1)
y <- -10 * x + 1.3 * z + rnorm(100, 0, 2)
datos2 <- data.frame(
x1_tto = factor(x, levels = c(0, 1), labels = c("Placebo", "Tratamiento Nuevo")),
x2_ttonum = x,
x3_peso_inicial = z,
y_peso_final = y)
mod <- lm(y_peso_final ~ x3_peso_inicial, data = datos2)
summary(mod)
library(broom)
mod %>%
tidy(conf.int = TRUE)
mod <- lm(y_peso_final ~ x1_tto, data = datos2)
summary(mod)
mod %>%
tidy(conf.int = TRUE)
#| echo: false
set.seed(123)
x <- c(rep(0, 25), rep(1, 25))
z <- rnorm(1000, 15, 1)
y <- -10 * x + 1.3 * z + rnorm(100, 0, 2)
datos2 <- data.frame(
x1_tto = factor(x, levels = c(0, 1), labels = c("Placebo", "Tratamiento Nuevo")),
x2_ttonum = x,
x3_peso_inicial = z,
y_peso_final = y)
mod <- lm(y_peso_final ~ x1_tto + x3_peso_inicial, data = datos2)
summary(mod)
library(broom)
mod %>%
tidy(conf.int = TRUE)
#| echo: false
#| fig-align: center
#| out-width: 100$
knitr::include_graphics("img/residuos-placa.png")
#| fig-width: 10
#| fig-height: 15
library(performance)
check_model(mod)
library(car)
crPlots(mod)
avPlots(mod)
residualPlots(mod, type = "rstudent")
dfbetasPlots(model = mod, id.n = 5)
#| fig-width: 10
#| fig-height: 15
influenceIndexPlot(model = mod, id.n = 5)
library(lmtest)
library(sandwich)
coeftest(mod, vcov = vcovHC) %>%
tidy(conf.int = TRUE)
mod <- glm(numcig ~ female age edlevel outwork hhninc year,
mod <- glm(numcig ~ female + age + edlevel + outwork + hhninc + year,
family = poisson(link = "log"),
data = md_visit)
summary(mod)
library(broom)
mod %>%
tidy(conf.int = TRUE, exponentiate = TRUE)
library(broom)
mod %>%
tidy(conf.int = TRUE, exponentiate = TRUE) %>%
gt()
library(broom)
mod %>%
tidy(conf.int = TRUE, exponentiate = TRUE)
datos <- import("hb.dta") %>%
characterize()
#| fig-width: 10
#| fig-height: 10
library(performance)
check_model(mod)
#| fig-width: 10
#| fig-height: 10
library(performance)
check_model(mod)
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("img/modelos1.png")
